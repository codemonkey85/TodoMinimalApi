@page "/"

<PageTitle>@App.SetPageTitle("List Todos")</PageTitle>

@if (todos is null)
{
    <MudText Typo="Typo.body1">Loading, please wait...</MudText>
}
else
{
    <MudDataGrid Items="@_items" T="TodoItemDTO"
    EditMode="DataGridEditMode.Form" CommittedItemChanges="@CommittedItemChanges"
    Dense="true" Bordered="false"
    ReadOnly="false" EditTrigger="DataGridEditTrigger.Manual">
        <ToolBarContent>
            <MudText Typo="Typo.h3">Todos</MudText>
            <MudSpacer />
            <MudIconButton Icon="@Icons.Material.Filled.Add" Variant="Variant.Filled" 
            Color="Color.Primary"/>
        </ToolBarContent>
        <Columns>
            <PropertyColumn Property="p => p.Name" Title="Name">
                <CellTemplate>
                    <MudStack Row>
                        @if(!context.Item.IsComplete)
                        {
                            <MudText Style="text-decoration: line-through;" Typo="Typo.body1">@context.Item.Name</MudText>
                        }
                        else
                        {
                            <MudText Typo="Typo.body1">@context.Item.Name</MudText>
                        }
                    </MudStack>
                </CellTemplate>
            </PropertyColumn>
            <PropertyColumn Property="p => p.IsComplete" Title="Status" Hidden="true">
                <EditTemplate>
                    <MudSwitch @bind-Value="context.Item.IsComplete"
                    Label="Complete?" LabelPlacement="Placement.Start"
                    Color="Color.Primary"/>
                </EditTemplate>
            </PropertyColumn>
            <TemplateColumn CellClass="d-flex justify-end">
                <CellTemplate>
                    <MudStack Row>
                        <MudIconButton OnClick="@context.Actions.StartEditingItemAsync"
                        Icon="@Icons.Material.Filled.Edit" Size="@Size.Small" />
                        <MudIconButton Icon="@Icons.Material.Filled.Delete" Size="@Size.Small"
                        Color="Color.Error" OnClick="@(async() => await DeleteItemAsync(context.Item))"/>
                    </MudStack>
                </CellTemplate>
            </TemplateColumn>
        </Columns>
    </MudDataGrid>
}